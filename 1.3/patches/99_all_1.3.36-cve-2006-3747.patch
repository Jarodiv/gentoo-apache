diff -ur apache_1.3.34/src/CHANGES apache_1.3.34.patches/src/CHANGES
--- apache_1.3.34/src/CHANGES	2005-10-12 06:38:00.000000000 -0700
+++ apache_1.3.34.patches/src/CHANGES	2006-07-26 09:17:52.000000000 -0700
@@ -1,3 +1,9 @@
+  *) SECURITY: CVE-2006-3747 (cve.mitre.org)
+     mod_rewrite: Fix an off-by-one security problem in the ldap scheme
+     handling.  For some RewriteRules this could lead to a pointer being
+     written out of bounds.  Reported by Mark Dowd of McAfee Avert Labs.
+     [Mark Cox]
+
 Changes with Apache 1.3.34
 
   *) hsregex: fix potential core dumping on 64 bit machines, such as
diff -ur apache_1.3.34/src/modules/standard/mod_rewrite.c apache_1.3.34.patches/src/modules/standard/mod_rewrite.c
--- apache_1.3.34/src/modules/standard/mod_rewrite.c	2004-11-24 11:10:19.000000000 -0800
+++ apache_1.3.34.patches/src/modules/standard/mod_rewrite.c	2006-07-26 09:16:09.000000000 -0700
@@ -2735,7 +2735,7 @@
             int c = 0;
 
             token[0] = cp = ap_pstrdup(p, cp);
-            while (*cp && c < 5) {
+            while (*cp && c < 4) {
                 if (*cp == '?') {
                     token[++c] = cp + 1;
                     *cp = '\0';
